---
doc_type: weread-highlights-reviews
bookId: "602973"
author: 姜承尧
cover: https://cdn.weread.qq.com/weread/cover/81/YueWen_602973/t7_YueWen_602973.jpg
reviewCount: 0
noteCount: 32
isbn: 9787111377641
category: 计算机-数据库
lastReadDate: 2021-05-17
---
# 元数据
> [!abstract] MySQL技术内幕：SQL编程
> - ![ MySQL技术内幕：SQL编程|200](https://cdn.weread.qq.com/weread/cover/81/YueWen_602973/t7_YueWen_602973.jpg)
> - 书名： MySQL技术内幕：SQL编程
> - 作者： 姜承尧
> - 简介： 本书是畅销书《MySQL技术内幕：InnoDB存储引擎》的姊妹篇，深刻揭示了MySQL中SQL编程的精髓与奥秘，能为开发者和DBA们利用SQL语言解决各种与开发和管理相关的MySQL难题提供很好的指导和帮助。网易CEO丁磊和多位数据库专家隆重推荐。全书一共10章，全面探讨了MySQL中SQL编程的各种方法、技巧与最佳实践。第1章首先介绍了SQL编程的概念、数据库的应用类型以及SQL查询分析器，然后介绍了SQL编程的三个阶段，希望读者通过本书的学习能达到最后的融合阶段。第2章全面讲解了MySQL中的各种数据类型和与之相对应的各种编程问题。第3章深入探讨了逻辑查询与物理查询的原理与方法。第4章的主题是子查询，不仅讲解了各种常用的子查询方法及其优化，而且还讲解了MariaDB对子查询的优化。第5章首先详细地分析了MySQL中的各种联接及其内部的实现算法，以及MariaDB数据库中引入的Hash Join，然后针对关于集合的各种操作给出了解决方案。第6章分享了聚合和旋转操作的方法与技巧，并对一些经典的常见问题给出了解决方案。第7章深入阐述了游标的使用，重点在于如何通过正确地使用游标来提高SQL编程的效率。第8章讲解了关于事务的各种编程技巧，同时对事务的分类进行了详细阐述。第9章详细分析了各种索引的内部实现，探讨了如何使用索引来提升查询效率。第10章介绍了分区的方法与技巧，阐明了如何通过分区来进行SQL编程。无论你是开发人员还是DBA，无论你是需要一本SQL查询手册还是希望系统深入地学习SQL编程，本书都会是不错的选择。
> - 出版时间 2012-04-10 00:00:00
> - ISBN： 9787111377641
> - 分类： 计算机-数据库
> - 出版社： 机械工业出版社

# 高亮划线

## 第2章 数据类型


- 📌 在MySQL数据库中，对于UNSIGNED数的操作，其返回值都是UNSIGNED的。 
    - ⏱ 2021-03-21 22:01:27 
## 第8章 事务编程


- 📌 对于InnoDB存储引擎而言，其默认的事务隔离级别为READ REPEATABLE 
    - ⏱ 2021-05-17 09:25:36 

- 📌 要么都做，要么都不做 
    - ⏱ 2021-05-17 09:28:21 

- 📌 原子性指整个数据库事务是不可分割的工作单位 
    - ⏱ 2021-05-17 09:28:32 

- 📌 一致性指事务将数据库从一种状态转变为另一种一致的状态。在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏 
    - ⏱ 2021-05-17 09:30:26 

- 📌 事务的隔离性要求每个读写事务的对象与其他事务的操作对象能相互分离，即该事务提交前对其他事务都不可见， 
    - ⏱ 2021-05-17 09:31:05 

- 📌 InnoDB存储引擎在REPEATABLE READ事务隔离级别下，使用Next-Key Lock的锁算法，因此避免了幻读的产生 
    - ⏱ 2021-05-17 09:57:26 
## 第9章 索引


- 📌 于磁盘的数据库系统、基于内存的数据库系统，以及混合型数据库系统 
    - ⏱ 2021-05-16 12:48:34 

- 📌 基于内存的数据库系统是最快的，因为数据库不需要对磁盘进行操作。磁盘的速度要远慢于内存的速度，因此基于磁盘的数据库系统一般都有缓冲池 
    - ⏱ 2021-05-16 12:49:07 

- 📌 将从磁盘上读取的指定大小数据—称为页（或块），放入缓冲池。当再次读取时，数据库首先判断该页是否在缓冲池中，如果在则直接读取缓冲池中的页，如果不在则读取磁盘上的页 
    - ⏱ 2021-05-16 12:49:21 

- 📌 据库将页读入缓冲池，然后在缓冲池中对页进行修改，修改完成后的页一般被异步地写入磁盘上。对于缓冲池的维护一般采用最近最少使用（Least Recently Used，LRU）算法。由此可见，缓冲池的大小决定了数据库的性能 
    - ⏱ 2021-05-16 12:49:44 

- 📌 顺序读取（sequntialread）是指顺序地读取磁盘上的页。随机读取（random read）是指访问的页不是连续的，需要磁盘的磁头不断移动 
    - ⏱ 2021-05-16 12:52:16 

- 📌 在InnoDB存储引擎中1个区是连续的64个页。因此在顺序读取数据库时，可以保证这64个页是连续的，而区与区之间的页，可能是连续的也可能是不连续的 
    - ⏱ 2021-05-16 12:52:43 

- 📌 B+树主要用于磁盘，因此页的拆分意味着磁盘的操作，应该在可能的情况下减少页的拆分 
    - ⏱ 2021-05-16 12:58:24 

- 📌 InnoDB存储引擎是索引组织表（Index Organized Table，IOT），也就是说数据文件本身就是按照B+树方式存放数据的 
    - ⏱ 2021-05-16 13:02:01 

- 📌 B+树的键值为主键，若在建立时没有显式地指定主键，则InnoDB存储引擎会自动创建一个6字节的列作为主键。因此在InnoDB存储引擎中，可以将B+树索引分为聚集索引（clustered index）和辅助索引（secondary index）。无论是何种索引，每个页的大小都为16KB，且不能更改。 
    - ⏱ 2021-05-16 13:02:17 

- 📌 聚集索引的叶子节点存放了表中的所有记录。辅助索引是根据索引键创建的一棵B+树，与聚集索引不同的是，其叶子节点仅存放索引键值，以及该索引键值指向的主键 
    - ⏱ 2021-05-16 13:02:40 

- 📌 如果通过辅助索引来查找数据，那么当找到辅助索引的叶子节点后，很有可能还需要根据主键值查找聚集索引来得到数据，这种查找方式又被称为书签查找 
    - ⏱ 2021-05-16 13:02:53 

- 📌 其索引叶节点存放的键值不是主键值，而是在MYD文件中的物理位置 
    - ⏱ 2021-05-16 13:17:09 

- 📌 如果某个字段的取值范围很广，几乎没有重复，即是高选择性的，那么此时使用B+树索引是最适合的。例如姓名字段，基本上在每一个应用中都不允许出现重名。 
    - ⏱ 2021-05-16 15:21:44 

- 📌 Cardinality值非常关键，表示索引中唯一只记录数量的预估值 
    - ⏱ 2021-05-16 15:22:15 

- 📌 对于查询SELECT ＊ FROM TABLE WHERE a=xxx and b=xxx，显然是可以使用（a，b）这个联合索引的。对于单个的a列查询SELECT ＊ FROM TABLEWHERE a=xxx也可以使用这个（a，b）索引 
    - ⏱ 2021-05-16 15:34:46 

- 📌 因此对于b列的查询不能使用（a，b）的索引。 
    - ⏱ 2021-05-16 15:33:16 

- 📌 联合索引的另一个好处是可以对第二个键值进行排序 
    - ⏱ 2021-05-16 15:34:28 

- 📌 覆盖索引（covering index），或称索引覆盖（indexcoverage），即从辅助索引中就可以得到查询的记录，而不需要查询聚集索引中的记录 
    - ⏱ 2021-05-16 15:35:10 

- 📌 覆盖索引的好处是辅助索引不包含整行记录的所有信息，故其大小要远小于聚集索引，因此可以减少大量的IO操作。 
    - ⏱ 2021-05-16 15:36:40 

- 📌 发现优化器并没有选择索引去查找数据，而是通过扫描聚集索引，也就是直接进行全表的扫描来得到数据。这种情况多发生于范围查找、JOIN操作等，例如： 
    - ⏱ 2021-05-16 15:43:33 

- 📌 原因在于我们要选取的数据是整行信息，而OrderID索引不能覆盖到我们要查询的信息，因此在对OrderID索引进行查询到指定数据的操作后，还需要进行一次书签访问来查找整行数据的信息 
    - ⏱ 2021-05-16 15:44:32 

- 📌 FORCE INDEX来强制使用某个索引 
    - ⏱ 2021-05-16 15:45:26 

- 📌 USE INDEX只是告诉优化器可以选择该索引，而实际上优化器还是会根据自己的判断进行选择。 
    - ⏱ 2021-05-16 15:47:29 

- 📌 因此，如果用户确定指定某个索引来完成查询，那么最可靠的是使用FORCE INDEX，而不是USE INDEX。 
    - ⏱ 2021-05-16 15:47:36 

- 📌 Memory存储引擎支持哈希索引。InnoDB存储引擎支持自适应哈希索引，用户仅能开启该特性，不能对其进行人工干预 
    - ⏱ 2021-05-16 15:56:03 
# 读书笔记

# 本书评论
